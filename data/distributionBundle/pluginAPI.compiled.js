#!/usr/bin/env node
// -*- coding: utf-8 -*-
'use strict';
module.exports=function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=16)}([function(a){a.exports=require('clientnode')},function(a){a.exports=require('source-map-support/register')},function(a){a.exports=require('fs')},function(a){a.exports=require('path')},function(a,b,c){'use strict';(function(a){function d(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0,b.configuration=void 0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(5),l=d(k),m=c(8),n=d(m);try{c(1)}catch(a){}for(n.default.webNode.context={path:a};n.default.webNode.context.path=j.default.resolve(n.default.webNode.context.path,'../../'),'node_modules'===j.default.basename(j.default.dirname(n.default.webNode.context.path)););if('/'===n.default.webNode.context.path||'node_modules'===j.default.basename(j.default.dirname(process.cwd()))||'.staging'===j.default.basename(j.default.dirname(process.cwd()))&&'node_modules'===j.default.basename(j.default.dirname(j.default.dirname(process.cwd()))))n.default.webNode.context.path=process.cwd();else try{h.default.lstatSync(j.default.join(process.cwd(),'node_modules')).isSymbolicLink()&&(n.default.webNode.context.path=process.cwd())}catch(a){}let o={};try{o=eval('require')(j.default.join(n.default.webNode.context.path,'package'))}catch(a){n.default.webNode.context.path=process.cwd()}const p=o.hasOwnProperty('documentationWebsite')&&o.documentationWebsite.name||o.name;o=o.webNode||{},p&&(o.name=p),n.default.webNode.name=n.default.documentationWebsite.name;const q=new Date,r={currentPath:process.cwd(),fileSystem:h.default,path:j.default,PluginAPI:l.default,require:eval('require'),Tools:f.default,webNodePath:a,now:q,nowUTCTimestamp:f.default.numberGetUTCTimestamp(q)};let s=b.configuration=f.default.evaluateDynamicDataStructure(n.default.webNode,r);if(delete n.default.webNode,f.default.extendObject(!0,f.default.modifyObject(s,o),o),2<process.argv.length){const a=f.default.stringParseEncodedObject(process.argv[process.argv.length-1],s,'configuration');f.default.isPlainObject(a)&&(f.default.extendObject(!0,f.default.modifyObject(s,a),a),s.runtimeConfiguration=a)}const t=(a)=>{for(const b in a)a.hasOwnProperty(b)&&!['__evaluate__','__execute__'].includes(b)&&(a.hasOwnProperty('__evaluate__')||a.hasOwnProperty('__execute__'))?delete a[b]:'object'==typeof a[b]&&null!==a[b]&&t(a[b]);return a};b.configuration=s=f.default.evaluateDynamicDataStructure(t(s),r),s.package=n.default,b.configuration=s=f.default.copyLimitedRecursively(s,-1,!0),b.default=s}).call(b,'/')},function(a,b,c){'use strict';(function(a){function d(a){return a&&a.__esModule?a:{default:a}}var e=c(6),f=d(e),g=c(7),h=c(0),i=d(h),j=c(2),k=d(j),l=c(3),m=d(l),n=c(4),o=d(n);b.__esModule=!0,b.PluginAPI=void 0;try{c(1)}catch(a){}class p{static callStack(a,b,c,d=null,...e){return(0,f.default)(function*(){if(c.plugin.hotReloading&&!['configurationLoaded','apiFileReloaded'].includes(a)){const a=p.hotReloadFile('configurationFile','configuration',b);a.length&&(p.callStack('preConfigurationLoaded',b,c,c,a),p.loadConfigurations(b,c),p.callStack('postConfigurationLoaded',b,c,c,a));const d=p.hotReloadFile('apiFile','scope',b);d.length&&p.callStack('apiFileReloaded',b,c,a)}for(const f of b)if(f.api){let g;try{g=yield f.api.call(p,a,d,...e.concat([c,b]))}catch(b){if('message'in b&&b.message.startsWith('NotImplemented:'))continue;throw new Error(`Plugin "${f.internalName}" `+(f.internalName===f.name?'':`(${f.name}) `)+`throws: ${i.default.representObject(b)} during `+`asynchrone hook "${a}".`)}d=g,c.debug&&console.info(`Ran asynchrone hook "${a}" for plugin "`+`${f.name}".`)}return d})()}static callStackSynchronous(a,b,c,d=null,...e){for(const f of b)if(f.api){let g;try{g=f.api.call(p,a,d,...e.concat([c,b]))}catch(b){if('message'in b&&b.message.startsWith('NotImplemented:'))continue;throw new Error(`Plugin "${f.internalName}" `+(f.internalName===f.name?'':`(${f.name}) `)+`throws: ${i.default.representObject(b)} during `+`synchrone hook "${a}".`)}d=g,c.debug&&console.info(`Ran synchrone hook "${a}" for plugin "`+`${f.name}".`)}return d}static hotReloadFile(a,b,c){const d=[];for(const e of c)if(e[a]){const c=k.default.statSync(e[`${a}Path`]).mtime.getTime();e[`${a}LoadTimestamp`]<c&&(delete eval('require').cache[eval('require').resolve(e[a])],e[b]=p.loadFile(e[a],e.name,e[b]),d.push(e)),e[`${a}LoadTimestamp`]=c}return d}static load(a,b,c,d,e,g='utf8'){return(0,f.default)(function*(){let f=m.default.resolve(e,'package.json'),h=null;f&&(yield i.default.isDirectory(e))&&(yield i.default.isFile(f))&&(h=p.loadFile(f,a));let j='index.js';if(h){const k=i.default.copyLimitedRecursively(h,-1,!0);for(const i of d)if(h.hasOwnProperty(i)){h.hasOwnProperty('main')&&(j=h.main);const d=h[i];return d.package=k,delete d.package[i],yield p.loadAPI(j,e,a,b,c,g,d,f)}return yield p.loadAPI(j,e,a,b,c,g,{package:k},f)}return yield p.loadAPI(j,e,a,b,c,g)})()}static loadAPI(a,b,c,d,e,h='utf8',j=null,l=null){return(0,f.default)(function*(){let f=m.default.resolve(b,a);if(!(yield i.default.isFile(f)))for(const a of k.default.readdirSync(b))if('package.json'!==a&&(yield i.default.isFile(m.default.resolve(b,a)))&&(f=m.default.resolve(b,f),['index','main'].includes(m.default.basename(f,m.default.extname(a)))))break;let n=null;return(yield i.default.isFile(f))&&(f.endsWith('.js')?n=function(a,b,...d){if(a in e[c].scope)return e[c].scope[a](b,...d);throw new Error(`NotImplemented: API method "${a}" is not `+`implemented in plugin "${c}".`)}:n=function(a,...b){const c=(0,g.spawnSync)(f,i.default.arrayMake(b),{cwd:process.cwd(),encoding:h,env:process.env,input:i.default.representObject(a),shell:!0,stdio:'inherit'});return c.stdout.startsWith('##')&&c.stdout.endsWith('##')&&(a=JSON.parse(a)),a}),{api:n,apiFilePath:n&&f,apiFileLoadTimestamp:n&&k.default.statSync(f).mtime.getTime(),configuration:j,configurationFilePath:l,configurationFileLoadTimestamp:l&&k.default.statSync(l).mtime.getTime()||null,dependencies:j&&j.hasOwnProperty('dependencies')&&j.dependencies||[],internalName:d,name:c,path:b,scope:n&&p.loadFile(f,c)}})()}static loadConfigurations(b,c){for(const a in c)c.hasOwnProperty(a)&&delete c[a];i.default.extendObject(c,i.default.copyLimitedRecursively(o.default,-1,!0));for(const a of b)if(a.configuration){const b=i.default.copyLimitedRecursively(a.configuration,-1,!0);delete b.package,i.default.extendObject(!0,i.default.modifyObject(c,b),b),c.runtimeConfiguration&&i.default.extendObject(!0,c,c.runtimeConfiguration)}const d=new Date,e=c.package;return delete c.package,c=i.default.evaluateDynamicDataStructure(p.removePropertiesInDynamicObjects(c),{currentPath:process.cwd(),fileSystem:k.default,path:m.default,PluginAPI:p,require:eval('require'),Tools:i.default,webNodePath:a,now:d,nowUTCTimestamp:i.default.numberGetUTCTimestamp(d)}),c.package=e,c}static loadFile(a,b,c=null,d=!0){let e;try{e=eval('require')(a)}catch(f){if(c)e=c,d&&console.warn(`Couln't load new api plugin file "${a}" for `+`plugin "${b}": ${i.default.representObject(f)}. `+`Using fallback one.`);else throw new Error(`Couln't load plugin file "${a}" for plugin "`+`${b}": ${i.default.representObject(f)}`)}return e.hasOwnProperty('default')?e.default:e}static loadAll(a){return(0,f.default)(function*(){const b={};for(const c in'webNode'!==a.name&&(b[a.name]=yield p.load(a.name,a.name,b,a.plugin.configurationPropertyNames,a.context.path,a.encoding)),a.plugin.directories)if(a.plugin.directories.hasOwnProperty(c)&&(yield i.default.isDirectory(a.plugin.directories[c].path))){const d=new RegExp(a.plugin.directories[c].nameRegularExpressionPattern);for(const e of k.default.readdirSync(a.plugin.directories[c].path)){if(!d.test(e))continue;const f=m.default.resolve(a.plugin.directories[c].path,e),g=e.replace(d,function(a,b){return'string'==typeof b?b:a});b[e]=yield p.load(e,g,b,a.plugin.configurationPropertyNames,f,a.encoding)}}const c={};for(const d in b)if(b.hasOwnProperty(d)&&(c[b[d].internalName]=b[d].dependencies,a.interDependencies.hasOwnProperty(b[d].internalName)))for(const e of[].concat(a.interDependencies[b[d].internalName]))c[b[d].internalName].includes(e)||c[b[d].internalName].push(e);const d=[];for(const a of i.default.arraySortTopological(c))for(const c in b)if(b.hasOwnProperty(c)&&[b[c].internalName,c].includes(a)){d.push(b[c]);break}return{plugins:d,configuration:p.loadConfigurations(d,a)}})()}static removePropertiesInDynamicObjects(a){for(const b in a)a.hasOwnProperty(b)&&!['__evaluate__','__execute__'].includes(b)&&(a.hasOwnProperty('__evaluate__')||a.hasOwnProperty('__execute__'))?delete a[b]:'object'==typeof a[b]&&null!==a[b]&&p.removePropertiesInDynamicObjects(a[b]);return a}}b.PluginAPI=p,b.default=p}).call(b,'/')},function(a){a.exports=require('babel-runtime/helpers/asyncToGenerator')},function(a){a.exports=require('child_process')},function(a){a.exports={name:'web-node',version:'1.0.134',license:'CC-BY-3.0',description:'High level javaScript backend plugin system and configuration merger.',homepage:'http://torben.website/webNode',documentationWebsite:{name:'webNode',trackingCode:'UA-40192634-9'},keywords:['web','backend','api','plugin','management'],files:['configurator.compiled.js','configurator.js','index.js','pluginAPI.compiled.js','pluginAPI.js','type.js','unixCrypt.compiled.js','unixCrypt.js'],main:'index.compiled.js',bin:{webNode:'index.compiled.js'},repository:{type:'git',url:'https://github.com/thaibault/webNode.git'},scripts:{build:'webOptimizer build',"build:dll":'webOptimizer build:dll',clear:'webOptimizer clear && rm --force log.txt &>/dev/null',document:'webOptimizer document',lint:'webOptimizer check:type; webOptimizer lint',prepare:'npm run build',serve:'webOptimizer build && ./index.compiled.js',start:'npm run serve',test:'cd dummyPlugin && npm run build && cd - && webOptimizer test',update:'npm version patch && npm publish',"update:documentation":'documentationWebsite --log-level info',watch:'webOptimizer build --watch',"watch:dll":'webOptimizer build:dll --watch'},dependencies:{clientnode:'^1.0.307',keypress:'^0.2.1'},peerDependencies:{"babel-runtime":'*'},devDependencies:{"babel-cli":'^6.24.1',"babel-eslint":'^8.0.3',"documentation-website":'^1.0.80',eslint:'^4.13.1',"eslint-config-google":'^0.9.1',"eslint-plugin-flowtype":'^2.40.1',"eslint-plugin-jsdoc":'^3.2.0',"flow-bin":'^0.61.0',jsdoc:'^3.5.2',qunit:'^2.4.1',"source-map-support":'^0.5.0',weboptimizer:'^1.0.437',webpack:'^3.10.0',"webpack-dev-server":'^2.9.7'},webNode:{debug:!1,encoding:'utf8',interDependencies:{},plugin:{configurationPropertyNames:['webNode'],directories:{internal:{path:{__evaluate__:'`${currentPath}/plugins/`'},nameRegularExpressionPattern:'^([a-zA-Z].*)$'},external:{path:{__evaluate__:'`${currentPath}/node_modules/`'},nameRegularExpressionPattern:'^([a-z][a-zA-Z0-9]+)[wW]eb[nN]ode[pP]lugin$'}},hotReloading:!0}},webOptimizer:{assetPattern:{javaScript:{pattern:'#!/usr/bin/env node\n// -*- coding: utf-8 -*-\n\'use strict\';\n{1}\n'}},exportFormat:{external:'commonjs2',self:'commonjs2'},injection:{internal:{__evaluate__:'2 < self.givenCommandLineArguments.length && self.givenCommandLineArguments[2] === \'test\' ? \'test\' : {configurator: \'./configurator\', index: \'./index\', pluginAPI: \'./pluginAPI\', unixCrypt: \'./unixCrypt\'}'}},module:{aliases:{"clientnode/test$":'clientnode/test.compiled'},optimizer:{babelMinify:{module:{mangle:!1}}}},targetTechnology:'node'}}},,,,,,,,function(a,b,c){a.exports=c(5)}]);
